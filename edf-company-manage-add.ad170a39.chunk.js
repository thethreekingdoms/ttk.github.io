webpackJsonp([88],{1024:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var n,r=l(a(0)),o=l(a(12)),s=l(a(7)),c=l(a(9)),u=l(a(10)),i=l(a(11)),f=a(1),d=(l(f),a(45)),p=l(a(614));function l(e){return e&&e.__esModule?e:{"default":e}}var m=(0,d.wrapper)(p["default"])(n=function(e){function t(){return(0,s["default"])(this,t),(0,u["default"])(this,(t.__proto__||(0,o["default"])(t)).apply(this,arguments))}return(0,i["default"])(t,e),(0,c["default"])(t,[{key:"render",value:function(){return this.props.monkeyKing((0,r["default"])({},this.props,{path:"root"}))}}]),t}(f.Component))||n;t["default"]=m,e.exports=t["default"]},1025:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r,l=u(a(22)),m=u(a(0)),h=u(a(83)),g=u(a(84)),o=u(a(7));t["default"]=function(e){var t=new s.action(e),a=b.FormDecorator.actionCreator((0,m["default"])({},e,{metaAction:t})),n=new i((0,m["default"])({},e,{metaAction:t,voucherAction:a})),r=(0,m["default"])({},t,a,n);return t.config({metaHandlers:r}),r};u(a(1));var s=a(45),c=(a(14),u(a(13)),u(a(438))),v=a(60),x=u(a(88)),b=a(59);function u(e){return e&&e.__esModule?e:{"default":e}}var i=(n=function e(t){(0,o["default"])(this,e),r.call(this),this.metaAction=t.metaAction,this.voucherAction=t.voucherAction,this.config=c["default"].current,this.webapi=this.config.webapi},r=function(){var t,a,n,r,o,s,c,u,i,f,d,p=this;this.onInit=function(e){var t=e.component,a=e.injections;p.voucherAction.onInit({component:t,injections:a}),p.component=t,p.injections=a,p.component.props.setOkListener&&p.component.props.setOkListener(p.onOk),a.reduce("init",{isPop:p.component.props.isPop}),p.loadSelect();var n=sessionStorage.getItem("currentOrgStatus");1!=n&&2!=n&&p.load()},this.load=(t=(0,g["default"])(h["default"].mark(function e(t){var a,n,r;return h["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.GetPropertyList();case 2:return a=e.sent,e.next=5,p.getData();case 5:return n=e.sent,e.next=8,p.webapi.portal.init();case 8:(r=e.sent).list=n,r.payload=a,t&&(r.org=t),r.user?p.metaAction.context.set("currentUser",r.user):(p.metaAction.context.set("currentUser",void 0),p.component.props.onRedirect&&p.config.goAfterLogout&&p.component.props.onRedirect(p.config.goAfterLogout)),r.org?p.metaAction.context.set("currentOrg",r.org):(p.metaAction.context.set("currentOrg",void 0),p.component.props.onRedirect&&p.config.goAfterLogout&&p.component.props.onRedirect(p.config.goAfterLogout)),p.injections.reduce("load",r),p.metaAction.sf("data.isShowSearch",!1),x["default"].setAccessToken(sessionStorage.getItem("_accessToken")),localStorage.setItem("token",sessionStorage.getItem("_accessToken"));case 18:case"end":return e.stop()}},e,p)})),function(e){return t.apply(this,arguments)}),this.loadSelect=(0,g["default"])(h["default"].mark(function e(){var t,a;return h["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=[]).push(v.consts["enum"].VATTAXPAYER),t.push(v.consts["enum"].ACCOUNTINGSTANDARDS),e.next=5,p.webapi.enumDetail.batchQuery(t);case 5:a=e.sent,p.injections.reduce("loadSelect",a[v.consts["enum"].VATTAXPAYER],a[v.consts["enum"].ACCOUNTINGSTANDARDS]);case 7:case"end":return e.stop()}},e,p)})),this.getData=(a=(0,g["default"])(h["default"].mark(function e(t){var a;return h["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.webapi.org.queryList();case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e,p)})),function(e){return a.apply(this,arguments)}),this.GetPropertyList=(0,g["default"])(h["default"].mark(function e(){return h["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{list:[{enumId:v.consts.VATTAXPAYER_generalTaxPayer,name:"一般纳税人"},{enumId:v.consts.VATTAXPAYER_smallScaleTaxPayer,name:"小规模纳税人"}]});case 1:case"end":return e.stop()}},e,p)})),this.create=(0,g["default"])(h["default"].mark(function e(){var t,a,n,r,o;return h["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.metaAction.gf("data.form").toJS(),a=p.metaAction.context.get("currentUser")||{},t=(0,m["default"])(t,{creator:a.id}),e.next=5,p.check([{path:"data.form.name",value:t.name},{path:"data.form.vatTaxpayer",value:t.vatTaxpayer},{path:"data.form.enabledDate",value:t.enabledDate},{path:"data.form.accountingStandards",value:t.accountingStandards}]);case 5:if(e.sent){e.next=8;break}return e.abrupt("return",!1);case 8:return n={creator:t.creator,name:t.name,vatTaxpayer:t.vatTaxpayer,enabledYear:t.enabledDate.split("-")[0],enabledMonth:t.enabledDate.split("-")[1],accountingStandards:t.accountingStandards,industry:2000030001},b.LoadingMask.show({background:"rgba(230,247,255,0.5)"}),e.next=12,p.webapi.org.create(n);case 12:return r=e.sent,e.next=15,p.webapi.org.updateCurrentOrg({orgId:r.id});case 15:if(o=e.sent,!r||!o){e.next=36;break}if(1!=sessionStorage.getItem("currentOrgStatus")&&2!=sessionStorage.getItem("currentOrgStatus")){e.next=28;break}if(e.t0=p.component.props.onPortalReload,!e.t0){e.next=22;break}return e.next=22,p.component.props.onPortalReload();case 22:p.metaAction.toast("success","创建成功"),b.LoadingMask.hide(),sessionStorage.currentOrgStatus=null,p.component.props.setPortalContent("门户首页","edfx-app-portal",{isShowMenu:!1,isTabsStyle:!1}),e.next=36;break;case 28:if(p.metaAction.toast("success","创建成功"),p.component.props.setPortalContent("门户首页","edfx-app-portal",{isShowMenu:!1,isTabsStyle:!1}),e.t1=p.component.props.onPortalReload,!e.t1){e.next=34;break}return e.next=34,p.component.props.onPortalReload();case 34:b.LoadingMask.hide(),sessionStorage.currentOrgStatus=null;case 36:case"end":return e.stop()}},e,p)})),this.cancel=(0,g["default"])(h["default"].mark(function e(){return h["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:p.component.props.setPortalContent("企业管理","edf-company-manage");case 1:case"end":return e.stop()}},e,p)})),this.goRegister=function(e){if(e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!p.config.apps["edfx-app-register"])throw"不存在edfx-app-register应用，该功能不能使用";p.component.props.onRedirect({appName:"edf-company-manage-add"})},this.goCompanyManage=function(e){if(e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!p.config.apps["edf-company-manage"])throw"edf-company-manage应用，该功能不能使用";p.component.props.onRedirect({appName:"edf-company-manage"})},this.searchVisibleToogle=function(){p.metaAction.sf("data.isShowSearch",!p.metaAction.gf("data.isShowSearch"))},this.getSearchVisible=function(){return p.metaAction.gf("data.isShowSearch")},this.fieldChange=(n=(0,g["default"])(h["default"].mark(function e(t,a){return h["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.check([{path:t,value:a}]);case 2:case"end":return e.stop()}},e,p)})),function(e,t){return n.apply(this,arguments)}),this.check=(r=(0,g["default"])(h["default"].mark(function e(t){var a,n,r,o,s,c,u,i,f,d;return h["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:a=[],r=!(n=!0),o=void 0,e.prev=6,s=(0,l["default"])(t);case 8:if(n=(c=s.next()).done){e.next=49;break}if(u=c.value,i=(0,m["default"])({},u),"data.form.name"!=u.path){e.next=20;break}return e.t0=m["default"],e.t1=i,e.next=16,p.checkName(u.value);case 16:e.t2=e.sent,(0,e.t0)(e.t1,e.t2),e.next=45;break;case 20:if("data.form.vatTaxpayer"!=u.path){e.next=29;break}return e.t3=m["default"],e.t4=i,e.next=25,p.checkVatTaxpayer(u.value);case 25:e.t5=e.sent,(0,e.t3)(e.t4,e.t5),e.next=45;break;case 29:if("data.form.enabledDate"!=u.path){e.next=38;break}return e.t6=m["default"],e.t7=i,e.next=34,p.checkEnableDate(u.value);case 34:e.t8=e.sent,(0,e.t6)(e.t7,e.t8),e.next=45;break;case 38:if("data.form.accountingStandards"!=u.path){e.next=45;break}return e.t9=m["default"],e.t10=i,e.next=43,p.checkAccountingStandards(u.value);case 43:e.t11=e.sent,(0,e.t9)(e.t10,e.t11);case 45:a.push(i);case 46:n=!0,e.next=8;break;case 49:e.next=55;break;case 51:e.prev=51,e.t12=e["catch"](6),r=!0,o=e.t12;case 55:e.prev=55,e.prev=56,!n&&s["return"]&&s["return"]();case 58:if(e.prev=58,!r){e.next=61;break}throw o;case 61:return e.finish(58);case 62:return e.finish(55);case 63:return f={},d=!0,a.forEach(function(e){f[e.path]=e.value,f[e.errorPath]=e.message,e.message&&(d=!1)}),p.metaAction.sfs(f),e.abrupt("return",d);case 68:case"end":return e.stop()}},e,p,[[6,51,55,63],[56,,58,62]])})),function(e){return r.apply(this,arguments)}),this.checkName=(o=(0,g["default"])(h["default"].mark(function e(t){var a;return h["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=4;break}a="请输入企业名称",e.next=8;break;case 4:return e.next=6,p.webapi.org.existsSysOrg(t);case 6:if(!e.sent){e.next=8;break}a="该企业名称已注册";case 8:return e.abrupt("return",{errorPath:"data.other.error.name",message:a});case 9:case"end":return e.stop()}},e,p)})),function(e){return o.apply(this,arguments)}),this.checkVatTaxpayer=(s=(0,g["default"])(h["default"].mark(function e(t){var a;return h["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t||(a="纳税人身份不能为空"),e.abrupt("return",{errorPath:"data.other.error.vatTaxpayer",message:a});case 2:case"end":return e.stop()}},e,p)})),function(e){return s.apply(this,arguments)}),this.checkEnableDate=(c=(0,g["default"])(h["default"].mark(function e(t){var a;return h["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t||(a="启用日期不能为空"),e.abrupt("return",{errorPath:"data.other.error.enableDate",message:a});case 2:case"end":return e.stop()}},e,p)})),function(e){return c.apply(this,arguments)}),this.checkAccountingStandards=(u=(0,g["default"])(h["default"].mark(function e(t){var a;return h["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t||(a="企业会计准则不能为空"),e.abrupt("return",{errorPath:"data.other.error.accountingStandards",message:a});case 2:case"end":return e.stop()}},e,p)})),function(e){return u.apply(this,arguments)}),this.topMenuClick=(i=(0,g["default"])(h["default"].mark(function e(t){return h["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.key,e.next="mySetting"===e.t0?3:"logout"===e.t0?7:13;break;case 3:if(p.config.apps["edfx-app-my-setting"]){e.next=5;break}throw"不存在edfx-app-my-setting应用，该功能不能使用";case 5:return p.setContent("个人设置","edfx-app-my-setting"),e.abrupt("break",13);case 7:if(!p.component.props.onRedirect||!p.config.goAfterLogout){e.next=12;break}return e.next=10,p.webapi.user.logout();case 10:e.sent&&(p.metaAction.context.set("currentUser",void 0),p.metaAction.context.set("currentOrg",void 0),sessionStorage.removeItem("mobile"),sessionStorage.removeItem("username"),sessionStorage.removeItem("_accessToken"),sessionStorage.removeItem("password"),p.component.props.onRedirect(p.config.goAfterLogout));case 12:return e.abrupt("break",13);case 13:case"end":return e.stop()}},e,p)})),function(e){return i.apply(this,arguments)}),this.setField=(f=(0,g["default"])(h["default"].mark(function e(t,a){return h["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:p.voucherAction.fieldChange(t,a);case 1:case"end":return e.stop()}},e,p)})),function(e,t){return f.apply(this,arguments)}),this.checkOrg=(d=(0,g["default"])(h["default"].mark(function e(t){return h["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.webapi.enumDetail.checkOrg({name:t});case 2:e.sent;case 3:case"end":return e.stop()}},e,p)})),function(e){return d.apply(this,arguments)}),this.changeDateState=function(){var e=p.metaAction.gf("data.other").toJS().editDate;p.metaAction.sf("data.other.editDate",!e)},this.changeStandardState=function(){var e=p.metaAction.gf("data.other").toJS().editStandard;p.metaAction.sf("data.other.editStandard",!e)}},n);e.exports=t["default"]},1026:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(a(0)),r=d(a(7));t["default"]=function(e){var t=new o.reducer(e),a=new p((0,n["default"])({},e,{metaReducer:t}));return(0,n["default"])({},t,a)};var s=a(14),o=a(45),c=d(a(438)),u=a(615),i=a(60),f=d(a(13));function d(e){return e&&e.__esModule?e:{"default":e}}var p=function e(t){var o=this;(0,r["default"])(this,e),this.init=function(e,t){var a=(0,u.getInitState)();return o.metaReducer.init(e,a)},this.load=function(e,t){if(t.list&&t.list.length){var a=t.payload.list.map(function(e){return{label:e.name,value:e.enumId}});e=o.metaReducer.sf(e,"data.form.vatTaxpayer",(0,s.fromJS)(a[0]&&Number(a[0].value))),e=o.metaReducer.sf(e,"data.other.vatTaxpayer",(0,s.fromJS)(a))}return e},this.loadSelect=function(e,t,a){e=o.metaReducer.sf(e,"data.vatTaxpayer",(0,s.fromJS)(t)),e=o.metaReducer.sf(e,"data.accountingStandards",(0,s.fromJS)(a));var n="";a.forEach(function(e){e.id!=i.consts.ACCOUNTINGSTANDARDS_2013||(n=e.name)}),e=o.metaReducer.sf(e,"data.form.accountingStandards",Number(i.consts.ACCOUNTINGSTANDARDS_2013)),e=o.metaReducer.sf(e,"data.form.accountingStandardsName",n);var r=(0,f["default"])().format("YYYY-MM");return e=o.metaReducer.sf(e,"data.form.vatTaxpayer",t[0].id),e=o.metaReducer.sf(e,"data.form.enabledDate",r)},this.metaReducer=t.metaReducer,this.config=c["default"].current};e.exports=t["default"]}});
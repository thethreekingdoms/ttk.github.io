webpackJsonp([79],{883:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var r,n=p(a(0)),u=p(a(12)),s=p(a(7)),o=p(a(9)),c=p(a(10)),i=p(a(11)),d=a(1),f=(p(d),a(45)),l=p(a(525));function p(e){return e&&e.__esModule?e:{"default":e}}var h=(0,f.wrapper)(l["default"])(r=function(e){function t(){return(0,s["default"])(this,t),(0,c["default"])(this,(t.__proto__||(0,u["default"])(t)).apply(this,arguments))}return(0,i["default"])(t,e),(0,o["default"])(t,[{key:"render",value:function(){return this.props.monkeyKing((0,n["default"])({},this.props,{path:"root"}))}}]),t}(d.Component))||r;t["default"]=h,e.exports=t["default"]},884:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=r(a(22)),m=r(a(0)),v=r(a(83)),f=r(a(84)),l=r(a(7));t["default"]=function(e){var t=new n.action(e),a=new u((0,m["default"])({},e,{metaAction:t})),r=(0,m["default"])({},t,a);return t.config({metaHandlers:r}),r};r(a(1));var n=a(45),b=(a(14),r(a(13)),r(a(387))),x=a(60);function r(e){return e&&e.__esModule?e:{"default":e}}var u=function e(t){var a,r,n,u,s,o,c,i,d,p=this;(0,l["default"])(this,e),this.onInit=(a=(0,f["default"])(v["default"].mark(function e(t){var a,r,n,u,s,o,c,i=t.component,d=t.injections;return v["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n in p.component=i,p.injections=d,p.component.props.initData,d.reduce("init"),a=[],r=x.consts["enum"])a.push(r[n]);return e.next=9,p.webapi.org.enumDetail({enumIdList:a});case 9:for(o in u=e.sent,s={},r)s[o]=u[r[o]];p.injections.reduce("enum",s),(c=p.component.props.addEventListener)&&c("onTabFocus",p.load),p.load();case 16:case"end":return e.stop()}},e,p)})),function(e){return a.apply(this,arguments)}),this.load=(0,f["default"])(v["default"].mark(function e(){var t,a;return v["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return p.component.props.editing(p.component.props.appName,!1),e.next=3,p.webapi.org.modify();case 3:return t=e.sent,p.injections.reduce("modify",t),e.next=7,p.webapi.org.query({id:p.getOrgId()});case 7:a=e.sent,p.injections.reduce("load",a[0]);case 9:case"end":return e.stop()}},e,p)})),this.saveOrg=(0,f["default"])(v["default"].mark(function e(){var t,a,r,n;return v["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.metaAction.gf("data.form").toJS(),a=p.metaAction.gf("data.error").toJS(),e.next=4,p.check([{path:"data.form.name",value:t.name},{path:"data.form.vatTaxpayer",value:t.vatTaxpayer},{path:"data.form.accountingStandards",value:t.accountingStandards},{path:"data.form.enableDate",value:t.enableDate},{path:"data.form.vatTaxpayerNum",value:t.vatTaxpayerNum}],"save");case 4:if(e.sent){e.next=7;break}return e.abrupt("return",!1);case 7:e.t0=v["default"].keys(a);case 8:if((e.t1=e.t0()).done){e.next=14;break}if(r=e.t1.value,null==a[r]){e.next=12;break}return e.abrupt("return");case 12:e.next=8;break;case 14:return n={},(n=(0,m["default"])(n,t)).id=p.getOrgId(),n.enabledYear=t.enableDate.split("-")[0],n.enabledMonth=t.enableDate.split("-")[1],e.next=21,p.webapi.org.update(n);case 21:e.sent&&(p.metaAction.toast("success","保存成功"),p.load(),p.metaAction.sf("data.other.name",t.name),p.metaAction.sf("data.other.enableDate",t.enableDate),p.component.props.onPortalReload&&p.component.props.onPortalReload());case 23:case"end":return e.stop()}},e,p)})),this.getCurrentOrg=function(){return p.metaAction.context.get("currentOrg")||{}},this.getOrgId=function(){var e=p.getCurrentOrg();return e?e.id:""},this.fieldChange=(r=(0,f["default"])(v["default"].mark(function e(t,a,r){return v["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return p.metaAction.sf(t,a),e.next=3,p.check([{path:t,value:a}],r);case 3:case"end":return e.stop()}},e,p)})),function(e,t,a){return r.apply(this,arguments)}),this.check=(n=(0,f["default"])(v["default"].mark(function e(t,a){var r,n,u,s,o,c,i,d,f,l;return v["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:r=[],u=!(n=!0),s=void 0,e.prev=6,o=(0,h["default"])(t);case 8:if(n=(c=o.next()).done){e.next=58;break}if(i=c.value,d=(0,m["default"])({},i),"data.form.name"!=i.path){e.next=20;break}return e.t0=m["default"],e.t1=d,e.next=16,p.name(i.value,a);case 16:e.t2=e.sent,(0,e.t0)(e.t1,e.t2),e.next=54;break;case 20:if("data.form.vatTaxpayer"!=i.path){e.next=29;break}return e.t3=m["default"],e.t4=d,e.next=25,p.vatTaxpayer(i.value,a);case 25:e.t5=e.sent,(0,e.t3)(e.t4,e.t5),e.next=54;break;case 29:if("data.form.accountingStandards"!=i.path){e.next=38;break}return e.t6=m["default"],e.t7=d,e.next=34,p.accountingStandards(i.value,a);case 34:e.t8=e.sent,(0,e.t6)(e.t7,e.t8),e.next=54;break;case 38:if("data.form.enableDate"!=i.path){e.next=47;break}return e.t9=m["default"],e.t10=d,e.next=43,p.enableDate(i.value,a);case 43:e.t11=e.sent,(0,e.t9)(e.t10,e.t11),e.next=54;break;case 47:if("data.form.vatTaxpayerNum"!=i.path){e.next=54;break}return e.t12=m["default"],e.t13=d,e.next=52,p.vatTaxpayerNum(i.value,a);case 52:e.t14=e.sent,(0,e.t12)(e.t13,e.t14);case 54:r.push(d);case 55:n=!0,e.next=8;break;case 58:e.next=64;break;case 60:e.prev=60,e.t15=e["catch"](6),u=!0,s=e.t15;case 64:e.prev=64,e.prev=65,!n&&o["return"]&&o["return"]();case 67:if(e.prev=67,!u){e.next=70;break}throw s;case 70:return e.finish(67);case 71:return e.finish(64);case 72:return f={},l=!0,r.forEach(function(e){f[e.errorPath]=e.message,e.message&&(l=!1)}),p.metaAction.sfs(f),e.abrupt("return",l);case 77:case"end":return e.stop()}},e,p,[[6,60,64,72],[65,,67,71]])})),function(e,t){return n.apply(this,arguments)}),this.name=(u=(0,f["default"])(v["default"].mark(function e(t,a){var r,n;return v["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=p.metaAction.gf("data.other.name"),t!=n){e.next=3;break}return e.abrupt("return",{errorPath:"data.error.name",message:r});case 3:if(!a||"save"!=a){e.next=8;break}return e.next=6,p.webapi.org.existsSysOrg(t);case 6:if(!e.sent){e.next=8;break}return e.abrupt("return",{errorPath:"data.error.name",message:"该企业名称已注册"});case 8:if(!(t.length<=50&&""!=t)){e.next=12;break}return e.abrupt("return",{errorPath:"data.error.name",message:r});case 12:t?50<t.length&&(r="企业名称不能超过50个字"):r="请输入企业名称";case 13:return e.abrupt("return",{errorPath:"data.error.name",message:r});case 14:case"end":return e.stop()}},e,p)})),function(e,t){return u.apply(this,arguments)}),this.vatTaxpayer=(s=(0,f["default"])(v["default"].mark(function e(t){var a;return v["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t||(a="请选择纳税人性质"),e.abrupt("return",{errorPath:"data.error.vatTaxpayer",message:a});case 2:case"end":return e.stop()}},e,p)})),function(e){return s.apply(this,arguments)}),this.accountingStandards=(o=(0,f["default"])(v["default"].mark(function e(t){var a;return v["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t||(a="请选择会计准则"),e.abrupt("return",{errorPath:"data.error.accountingStandards",message:a});case 2:case"end":return e.stop()}},e,p)})),function(e){return o.apply(this,arguments)}),this.enableDate=(c=(0,f["default"])(v["default"].mark(function e(t,a){var r,n,u,s;return v["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=p.metaAction.gf("data.other.enableDate"),t!=n){e.next=3;break}return e.abrupt("return",{errorPath:"data.error.enableDate",message:r});case 3:if(t){e.next=5;break}return e.abrupt("return",{errorPath:"data.error.enableDate",message:"请选择启用时间"});case 5:return(u={}).toYear=t.split("-")[0],u.toMonth=Number(t.split("-")[1]),e.next=10,p.webapi.updatePeriod(u);case 10:return(s=e.sent).result||s.result||(r=s.error.message),e.abrupt("return",{errorPath:"data.error.enableDate",message:r});case 13:case"end":return e.stop()}},e,p)})),function(e,t){return c.apply(this,arguments)}),this.vatTaxpayerNum=(i=(0,f["default"])(v["default"].mark(function e(t,a){var r;return v["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a||"save"!=a){e.next=4;break}t?t.length<=14?r="纳税人识别号位数错误":14<t.length&&15!==t.length&&18!==t.length&&20!==t.length?r="纳税人识别号位数错误":20<t.length&&(r="纳税人识别号不能超过20个字"):r="请输入纳税人识别号",e.next=13;break;case 4:if(t){e.next=8;break}r="请输入纳税人识别号",e.next=13;break;case 8:if(!(t.length<=14)){e.next=12;break}return e.abrupt("return",{errorPath:"data.error.vatTaxpayerNum",message:r});case 12:14<t.length&&15!==t.length&&18!==t.length&&20!==t.length?r="纳税人识别号位数错误":20<t.length&&(r="纳税人识别号不能超过20个字");case 13:return e.abrupt("return",{errorPath:"data.error.vatTaxpayerNum",message:r});case 14:case"end":return e.stop()}},e,p)})),function(e,t){return i.apply(this,arguments)}),this.checkNotRequire=(d=(0,f["default"])(v["default"].mark(function e(t,a,r,n){var u;return v["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r.length>t&&(u=n+"不能超过"+t+"个字"),p.metaAction.sf(a,u);case 2:case"end":return e.stop()}},e,p)})),function(e,t,a,r){return d.apply(this,arguments)}),this.setAddress=function(e){var t,a=e.toJS();p.metaAction.sf("data.form.registeredProvincial",a.provinces),p.metaAction.sf("data.form.registeredCity",a.citys),p.metaAction.sf("data.form.registeredCounty",a.districts),p.metaAction.sf("data.form.registeredAddress",a.text),50<a.text.length&&(t="注册地址不能超过50个字"),p.metaAction.sf("data.error.address",t)},this.reinit=(0,f["default"])(v["default"].mark(function e(){return v["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.metaAction.modal("show",{title:"重新初始化",width:652,height:311,children:p.metaAction.loadApp("edfx-app-org-reinit",{store:p.component.props.store})});case 2:e.sent.canModify&&p.component.props.reInitContent();case 4:case"end":return e.stop()}},e,p)})),this.metaAction=t.metaAction,this.extendAction=t.extendAction,this.config=b["default"].current,this.webapi=this.config.webapi};e.exports=t["default"]},885:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n,u=d(a(0)),s=d(a(7));t["default"]=function(e){var t=new c.reducer(e),a=new f((0,u["default"])({},e,{metaReducer:t}));return(0,u["default"])({},t,a)};var o=a(14),c=a(45),i=(d(a(387)),d(a(13)),a(526));function d(e){return e&&e.__esModule?e:{"default":e}}var f=(r=function e(t){(0,s["default"])(this,e),n.call(this),this.metaReducer=t.metaReducer},n=function(){var a=this;this.init=function(e,t){return e=a.metaReducer.init(e,(0,i.getInitState)(t))},this.load=function(e,t){return e=a.metaReducer.sf(e,"data.other.ts",t.ts),e=a.metaReducer.sf(e,"data.form",(0,o.fromJS)(t)),e=a.metaReducer.sf(e,"data.form.enableDate",t.enabledYear+"-"+t.enabledMonth),e=a.metaReducer.sf(e,"data.other.name",t.name),e=a.metaReducer.sf(e,"data.other.enableDate",t.enabledYear+"-"+t.enabledMonth)},this["enum"]=function(e,t){return a.metaReducer.sf(e,"data.enum",(0,o.fromJS)(t))},this.modify=function(e,t){return a.metaReducer.sf(e,"data.canModify",t)}},r);e.exports=t["default"]}});